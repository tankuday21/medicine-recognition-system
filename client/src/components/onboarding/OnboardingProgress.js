// Onboarding Progress Component\n// Track and display onboarding completion and rewards\n\nimport React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { onboardingFlowManager } from '../../utils/onboardingSystem';\nimport { Button } from '../ui/Button';\nimport { Card } from '../ui/Card';\nimport { Progress } from '../ui/Progress';\nimport { Badge } from '../ui/Badge';\n\n/**\n * Onboarding Progress Dashboard\n */\nexport const OnboardingProgress = ({ userId, onFlowStart, onFlowReset }) => {\n  const [stats, setStats] = useState(null);\n  const [personalizedPath, setPersonalizedPath] = useState(null);\n  const [completedFlows, setCompletedFlows] = useState([]);\n  const [availableFlows, setAvailableFlows] = useState([]);\n  const [showRewards, setShowRewards] = useState(false);\n\n  useEffect(() => {\n    loadProgressData();\n  }, [userId]);\n\n  const loadProgressData = () => {\n    const progressStats = onboardingFlowManager.getOnboardingStats();\n    setStats(progressStats);\n\n    // Get personalized path if exists\n    if (userId) {\n      const path = onboardingFlowManager.personalizedPaths.get(userId);\n      setPersonalizedPath(path);\n    }\n\n    // Get completed and available flows\n    const completed = Array.from(onboardingFlowManager.completedFlows);\n    setCompletedFlows(completed);\n\n    const available = [];\n    for (const [flowId, flow] of onboardingFlowManager.flows) {\n      if (!completed.includes(flowId)) {\n        available.push({ id: flowId, ...flow });\n      }\n    }\n    setAvailableFlows(available);\n  };\n\n  const handleStartFlow = (flowId) => {\n    if (onFlowStart) {\n      onFlowStart(flowId);\n    }\n  };\n\n  const handleResetFlow = (flowId) => {\n    onboardingFlowManager.resetProgress(flowId);\n    loadProgressData();\n    if (onFlowReset) {\n      onFlowReset(flowId);\n    }\n  };\n\n  const getCompletionLevel = () => {\n    if (!stats) return 'beginner';\n    \n    const completionRate = (stats.completedFlows / stats.totalFlows) * 100;\n    \n    if (completionRate >= 80) return 'expert';\n    if (completionRate >= 50) return 'intermediate';\n    return 'beginner';\n  };\n\n  const getRewards = () => {\n    const level = getCompletionLevel();\n    const rewards = [];\n\n    if (stats.completedFlows >= 1) {\n      rewards.push({\n        id: 'first-flow',\n        title: 'Getting Started',\n        description: 'Completed your first onboarding flow',\n        icon: 'ðŸŽ¯',\n        earned: true\n      });\n    }\n\n    if (stats.completedFlows >= 3) {\n      rewards.push({\n        id: 'explorer',\n        title: 'Explorer',\n        description: 'Completed multiple onboarding flows',\n        icon: 'ðŸ—ºï¸',\n        earned: true\n      });\n    }\n\n    if (level === 'expert') {\n      rewards.push({\n        id: 'expert',\n        title: 'Onboarding Expert',\n        description: 'Mastered the platform with 80%+ completion',\n        icon: 'ðŸ†',\n        earned: true\n      });\n    }\n\n    if (stats.averageCompletionTime > 0 && stats.averageCompletionTime < 300000) { // 5 minutes\n      rewards.push({\n        id: 'speed-learner',\n        title: 'Speed Learner',\n        description: 'Completed flows quickly and efficiently',\n        icon: 'âš¡',\n        earned: true\n      });\n    }\n\n    return rewards;\n  };\n\n  if (!stats) {\n    return (\n      <div className=\"animate-pulse space-y-4\">\n        <div className=\"h-6 bg-gray-200 rounded w-1/3\"></div>\n        <div className=\"h-32 bg-gray-200 rounded\"></div>\n        <div className=\"h-24 bg-gray-200 rounded\"></div>\n      </div>\n    );\n  }\n\n  const rewards = getRewards();\n  const completionPercentage = (stats.completedFlows / stats.totalFlows) * 100;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Overall Progress */}\n      <Card className=\"p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">\n            Onboarding Progress\n          </h2>\n          <Badge variant={getCompletionLevel() === 'expert' ? 'success' : 'primary'}>\n            {getCompletionLevel()}\n          </Badge>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div>\n            <div className=\"flex justify-between text-sm text-gray-600 mb-2\">\n              <span>Overall Completion</span>\n              <span>{stats.completedFlows} of {stats.totalFlows} flows</span>\n            </div>\n            <Progress \n              value={completionPercentage} \n              className=\"h-3\"\n              aria-label={`${Math.round(completionPercentage)}% complete`}\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t border-gray-200\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {stats.completedFlows}\n              </div>\n              <div className=\"text-sm text-gray-600\">Completed</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-orange-600\">\n                {stats.inProgressFlows}\n              </div>\n              <div className=\"text-sm text-gray-600\">In Progress</div>\n            </div>\n            <div className=\"text-2xl font-bold text-green-600 text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {stats.completedSteps}\n              </div>\n              <div className=\"text-sm text-gray-600\">Steps Done</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-purple-600\">\n                {Math.round(stats.averageCompletionTime / 60000) || 0}m\n              </div>\n              <div className=\"text-sm text-gray-600\">Avg Time</div>\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Rewards Section */}\n      {rewards.length > 0 && (\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">\n              Achievements\n            </h3>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => setShowRewards(!showRewards)}\n            >\n              {showRewards ? 'Hide' : 'Show'} ({rewards.length})\n            </Button>\n          </div>\n\n          <AnimatePresence>\n            {showRewards && (\n              <motion.div\n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: 'auto' }}\n                exit={{ opacity: 0, height: 0 }}\n                className=\"grid gap-3\"\n              >\n                {rewards.map((reward) => (\n                  <motion.div\n                    key={reward.id}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    className=\"flex items-center space-x-3 p-3 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border border-yellow-200\"\n                  >\n                    <div className=\"text-2xl\">{reward.icon}</div>\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-gray-900\">\n                        {reward.title}\n                      </h4>\n                      <p className=\"text-sm text-gray-600\">\n                        {reward.description}\n                      </p>\n                    </div>\n                    <Badge variant=\"success\" size=\"sm\">\n                      Earned\n                    </Badge>\n                  </motion.div>\n                ))}\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </Card>\n      )}\n\n      {/* Personalized Path */}\n      {personalizedPath && (\n        <Card className=\"p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Your Learning Path\n          </h3>\n          \n          <div className=\"space-y-3\">\n            {personalizedPath.flows.map((flowId, index) => {\n              const isCompleted = completedFlows.includes(flowId);\n              const flow = onboardingFlowManager.flows.get(flowId);\n              \n              return (\n                <div\n                  key={flowId}\n                  className={`flex items-center space-x-3 p-3 rounded-lg border ${\n                    isCompleted \n                      ? 'bg-green-50 border-green-200' \n                      : 'bg-gray-50 border-gray-200'\n                  }`}\n                >\n                  <div className={`w-8 h-8 rounded-full flex items-center justify-center ${\n                    isCompleted \n                      ? 'bg-green-500 text-white' \n                      : 'bg-gray-300 text-gray-600'\n                  }`}>\n                    {isCompleted ? (\n                      <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                      </svg>\n                    ) : (\n                      <span className=\"text-sm font-medium\">{index + 1}</span>\n                    )}\n                  </div>\n                  \n                  <div className=\"flex-1\">\n                    <h4 className=\"font-medium text-gray-900\">\n                      {flow?.title || flowId}\n                    </h4>\n                    <p className=\"text-sm text-gray-600\">\n                      {flow?.description || 'Custom flow'}\n                    </p>\n                  </div>\n                  \n                  {!isCompleted && (\n                    <Button\n                      size=\"sm\"\n                      onClick={() => handleStartFlow(flowId)}\n                    >\n                      Start\n                    </Button>\n                  )}\n                </div>\n              );\n            })}\n          </div>\n          \n          <div className=\"mt-4 p-3 bg-blue-50 rounded-lg\">\n            <p className=\"text-sm text-blue-800\">\n              ðŸ’¡ This path is personalized based on your role and experience level.\n              Estimated total time: ~{personalizedPath.estimatedTime} minutes.\n            </p>\n          </div>\n        </Card>\n      )}\n\n      {/* Available Flows */}\n      {availableFlows.length > 0 && (\n        <Card className=\"p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Available Onboarding Flows\n          </h3>\n          \n          <div className=\"grid gap-4\">\n            {availableFlows.map((flow) => (\n              <div\n                key={flow.id}\n                className=\"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-colors\"\n              >\n                <div className=\"flex-1\">\n                  <h4 className=\"font-medium text-gray-900 mb-1\">\n                    {flow.title}\n                  </h4>\n                  <p className=\"text-sm text-gray-600 mb-2\">\n                    {flow.description}\n                  </p>\n                  <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n                    <span>~{flow.estimatedTime} minutes</span>\n                    <span>{flow.steps.length} steps</span>\n                    {flow.prerequisite && (\n                      <span>Requires: {flow.prerequisite}</span>\n                    )}\n                  </div>\n                </div>\n                \n                <div className=\"flex space-x-2\">\n                  <Button\n                    size=\"sm\"\n                    onClick={() => handleStartFlow(flow.id)}\n                    disabled={flow.prerequisite && !completedFlows.includes(flow.prerequisite)}\n                  >\n                    Start\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n\n      {/* Completed Flows */}\n      {completedFlows.length > 0 && (\n        <Card className=\"p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Completed Flows\n          </h3>\n          \n          <div className=\"space-y-3\">\n            {completedFlows.map((flowId) => {\n              const flow = onboardingFlowManager.flows.get(flowId);\n              const progress = onboardingFlowManager.userProgress.get(flowId);\n              \n              return (\n                <div\n                  key={flowId}\n                  className=\"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg\"\n                >\n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center\">\n                      <svg className=\"w-5 h-5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                      </svg>\n                    </div>\n                    \n                    <div>\n                      <h4 className=\"font-medium text-gray-900\">\n                        {flow?.title || flowId}\n                      </h4>\n                      {progress?.completedAt && (\n                        <p className=\"text-sm text-gray-600\">\n                          Completed {new Date(progress.completedAt).toLocaleDateString()}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  \n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleResetFlow(flowId)}\n                    className=\"text-gray-600 hover:text-gray-800\"\n                  >\n                    Reset\n                  </Button>\n                </div>\n              );\n            })}\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n};\n\n/**\n * Onboarding Progress Widget (Compact)\n */\nexport const OnboardingProgressWidget = ({ userId, onViewDetails }) => {\n  const [stats, setStats] = useState(null);\n  const [nextFlow, setNextFlow] = useState(null);\n\n  useEffect(() => {\n    const progressStats = onboardingFlowManager.getOnboardingStats();\n    setStats(progressStats);\n\n    if (userId) {\n      const next = onboardingFlowManager.getNextRecommendedFlow(userId);\n      setNextFlow(next);\n    }\n  }, [userId]);\n\n  if (!stats) {\n    return (\n      <Card className=\"p-4 animate-pulse\">\n        <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\n        <div className=\"h-2 bg-gray-200 rounded\"></div>\n      </Card>\n    );\n  }\n\n  const completionPercentage = (stats.completedFlows / stats.totalFlows) * 100;\n\n  return (\n    <Card className=\"p-4\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <h3 className=\"font-medium text-gray-900\">\n          Onboarding Progress\n        </h3>\n        <span className=\"text-sm text-gray-600\">\n          {stats.completedFlows}/{stats.totalFlows}\n        </span>\n      </div>\n      \n      <Progress \n        value={completionPercentage} \n        className=\"mb-3\"\n        aria-label={`${Math.round(completionPercentage)}% complete`}\n      />\n      \n      {nextFlow && (\n        <div className=\"mb-3\">\n          <p className=\"text-sm text-gray-600 mb-2\">\n            Next: {nextFlow.title}\n          </p>\n          <Button size=\"sm\" className=\"w-full\">\n            Continue Learning\n          </Button>\n        </div>\n      )}\n      \n      {onViewDetails && (\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={onViewDetails}\n          className=\"w-full text-gray-600 hover:text-gray-800\"\n        >\n          View Details\n        </Button>\n      )}\n    </Card>\n  );\n};\n\nexport default OnboardingProgress;"